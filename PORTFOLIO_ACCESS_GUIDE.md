# Руководство по доступу к портфолио студентов

## Обзор

Система MELSU Portal теперь поддерживает доступ кураторов, сотрудников кафедр и факультетов к портфолио студентов. Это позволяет руководящему составу отслеживать академические и внеучебные достижения студентов.

## Кто имеет доступ

### 1. Кураторы
- Имеют доступ к портфолио студентов своих групп
- Доступ основан на назначениях через систему `UserDepartmentAssignment` с типом `curator`

### 2. Сотрудники кафедр
- Имеют доступ к портфолио студентов своей кафедры
- Доступ основан на назначениях к подразделению типа `department`

### 3. Сотрудники факультетов
- Имеют доступ к портфолио всех студентов факультета
- Доступ основан на назначениях к подразделению типа `faculty`

### 4. Администраторы
- Имеют полный доступ ко всем портфолио

## Функциональность

### Просмотр списка студентов
- Страница: `/references/students`
- Показывает студентов, к которым есть доступ
- Фильтрация по факультету, кафедре, курсу
- Поиск по имени, email, номеру студенческого билета

### Просмотр портфолио студента
- Страница: `/student-portfolio/{studentId}`
- Полная информация о студенте
- Статистика достижений по категориям
- Список всех достижений с фильтрацией
- Возможность скачивания прикрепленных файлов

## API Endpoints

### Получение информации о студенте
```
GET /api/portfolio/student/{student_id}/info
```

### Получение статистики портфолио
```
GET /api/portfolio/student/{student_id}/stats
```

### Получение достижений студента
```
GET /api/portfolio/student/{student_id}/achievements?category={category}
```

## Система разрешений

### Проверка доступа
Функция `check_portfolio_view_access` в `backend/app/api/portfolio.py` проверяет:

1. **Собственное портфолио**: Студент всегда может просматривать свое портфолио
2. **Права администратора**: Администраторы имеют доступ ко всем портфолио
3. **Кураторский доступ**: Через группы в подразделениях куратора
4. **Доступ подразделений**: Через иерархию факультет -> кафедра

### Логика доступа для кураторов
```
Куратор → Назначения типа 'curator' → Подразделения → Группы → Студенты
```

### Логика доступа для подразделений
```
Сотрудник → Назначения → Подразделения → Факультет/Кафедра → Студенты
```

## Категории достижений

- **academic**: Академические достижения
- **sports**: Спортивные достижения  
- **creative**: Творческие достижения
- **volunteer**: Волонтерские мероприятия
- **professional**: Профессиональные достижения

## Компоненты Frontend

### StudentList.jsx
- Список студентов с кнопками "Портфолио"
- Фильтрация и поиск
- Отображение основной информации

### StudentPortfolio.jsx
- Детальный просмотр портфолио студента
- Информация о студенте
- Статистика по категориям
- Список достижений с фильтрацией
- Скачивание файлов

## Маршрутизация

В `App.jsx` добавлен маршрут:
```jsx
<Route path="/student-portfolio/:studentId" element={<StudentPortfolio />} />
```

Доступен для пользователей с ролями: `employee`, `teacher`, `admin`.

## Безопасность

- Все API проверяют права доступа перед предоставлением данных
- Студенты могут видеть только свои портфолио
- Кураторы видят только студентов своих групп
- Сотрудники видят только студентов своих подразделений
- Файлы доступны только авторизованным пользователям с соответствующими правами

## Использование

### Для кураторов
1. Перейти в "Справочники" → "Студенты"
2. Найти нужного студента
3. Нажать кнопку "Портфолио"
4. Просмотреть достижения и файлы

### Для сотрудников подразделений
1. Перейти в "Справочники" → "Студенты"
2. Использовать фильтры по факультету/кафедре
3. Просмотреть портфолио интересующих студентов

### Навигация
- Кнопка "Назад к списку студентов" для возврата
- Фильтры по категориям достижений
- Прямые ссылки на файлы для скачивания

## Техническая реализация

### База данных
Использует существующие таблицы:
- `users` - пользователи
- `user_profiles` - профили студентов  
- `user_department_assignments` - назначения
- `portfolio_achievements` - достижения
- `portfolio_files` - файлы

### Проверка прав
- Асинхронная функция проверки доступа
- Интеграция с системой ролей
- Поддержка иерархии подразделений

### API дизайн
- RESTful endpoints
- Консистентная обработка ошибок
- Поддержка фильтрации и пагинации 